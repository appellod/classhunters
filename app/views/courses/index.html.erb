<% if @user.present? %>
	<% provide(:title, 'My Courses') %>
  <h1>My Courses</h1>
<% elsif @school.present? %>
	<% provide(:title, "Courses at #{@school.name}".html_safe) %>
	<% breadcrumbs({ 'Home'=>root_url, 'Schools'=>schools_path, @school.name=>school_path(@school), 'Courses'=>'' }) %>
  <h1>Courses at <%= @school.name %></h1>
<% else %>
	<% provide(:title, 'Search Courses') %>
	<% breadcrumbs({ 'Home'=>root_url, 'Courses'=>"" }) %>
  <h1>Search Courses</h1>
<% end %>

<div class="sort">
	<strong>Courses</strong>
	 | 
	<% if @school.present? %>
		<%= link_to "Sessions", school_sessions_path(@school) %>
	<% else %>
		<%= link_to "Sessions", course_sessions_path %>
	<% end %>
</div>

<% if @school.nil? && params[:search].nil? %>
	<%= form_tag (@school.present? ? school_courses_path(@school) : courses_path), method: :get, class: "course_search" do %>
      <label>Search:</label>
      <%= text_field_tag :search, params[:search], placeholder: 'Business, Computers, etc...' %>
    <%= submit_tag 'Search', id: 'submit', class: "btn btn-large btn-primary" %>
  <% end %>
<% else %>
	<div class="expand button">+ Advanced Search Options</div>
	<div class="expand-container">
	  <%= form_tag (@school.present? ? school_courses_path(@school) : courses_path), method: :get, id: "search_form" do %>
	    <div class="col-sm-6">
	      <label>Search:</label>
	      <%= text_field_tag :search, params[:search], placeholder: 'Business, Computers, etc...' %>
	    </div>
	    <% if @school.nil? %>
		    <div class="col-sm-6">
		      <%= render 'location_form' %>
		    </div>
		  <% end %>
		  <% if @school.present? %>
		    <div class="col-sm-6">
		    	<%= render 'departments_form' %>
		    </div>
		  <% end %>
	    <%= hidden_field_tag :semester, params[:semester] %>
	    <%= hidden_field_tag :sort, params[:sort] %>
	    <%= hidden_field_tag :order, params[:order] %>
	    <div style="clear: both"></div>
	    <%= submit_tag 'Search', id: 'submit', class: "btn btn-large btn-primary" %>
	  <% end %>
	</div>
<% end %>

<% if @school.present? %>
	<% if @courses.present? && @courses.count > 0 %>
		<%= will_paginate @courses %>
			<table class="courses">
				<tr><th>Name</th><th>Department</th></tr>
			  <%= render @courses %>
			</table>
		<%= will_paginate @courses %>
	<% else %>
		<div class="empty">There are currently no course listings for this school.</div>
	<% end %>
<% else %>
	<% if @courses.present? && @courses.count > 0 %>
		<div class="results-count"><%= @course_count %> Courses Found!</div>
		<% @courses.each do |school| %>
			<%= render 'school', school: school[0], courses: school[1] %>
		<% end %>
	<% elsif params[:search].present? %>
		<div class="empty">There are no courses matching your search terms.</div>
	<% end %>
<% end %>